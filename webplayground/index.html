<!-- Generated by ChatGPT -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lreng</title>
    <style>
        body {
            font-family: Tahoma, Helvetica, Arial, sans-serif;
        }
    </style>
</head>
<body>
    <h1>ɭeŋ: A simple minimal interpreted functional programming language</h1>
    <div>
        <label for="file-content">Write your program here:</label><br>
        <textarea id="file-content" rows="10" cols="50"></textarea><br><br>
        <label for="stdin">stdin:</label><br>
        <input id="stdin" type="text" placeholder="Enter characters"><br><br>
        <button onclick="runProgram()">Run Program</button>
    </div>
    <h2>stdout:</h2>
    <pre id="stdout"></pre>

    <script src="lreng.js"></script>
    <script>
        // Redirect stdin and stdout
        let stdin = document.getElementById('stdin').value;
        let stdinStream = new TextEncoder().encode(stdin + '\n');
        let stdinIndex = 0;
        const outputElement = document.getElementById('stdout');
        Module.FS.init(
            () => stdinStream[stdinIndex++] || null, // Read from stdin
            char => outputElement.textContent += String.fromCharCode(char), // Write to stdout
            char => outputElement.textContent += String.fromCharCode(char)  // Write to stderr
        );

        async function runProgram() {
            // Get user inputs
            const fileContent = document.getElementById('file-content').value;
            stdin = document.getElementById('stdin').value;
            stdinStream = new TextEncoder().encode(stdin + '\n');
            stdinIndex = 0;

            // Remove previously created file
            try {
                FS.unlink('input.txt');
            } catch (e) {
                // Ignore errors if the file doesn't exist
            }

            // Prepare the virtual file system
            FS.writeFile('input.txt', fileContent);
            
            // Clear previous output
            outputElement.textContent = '';

            // Run the program
            await Module.callMain(["input.txt"]);
        }
    </script>
</body>
</html>